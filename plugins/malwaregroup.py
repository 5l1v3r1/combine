from yapsy.IPlugin import IPlugin
import bs4

class PluginOne(IPlugin):
    NAME = "malwaregroup"
    DIRECTION = "outbound"
    URLS = ['http://www.malwaregroup.com/ipaddresses']

    def get_URLs(self):
        return self.URLS

    def get_direction(self):
        return self.DIRECTION

    def get_name(self):
        return self.NAME

    def process_data(self, source, response):
        data = []
        soup = bs4.BeautifulSoup(response)
        for row in soup.find_all('tr'):
            if row.td:
                i = row.td.text
                date = row.contents[-1].text
                data.append((i, "IPv4", self.DIRECTION, self.NAME, '', date))
        return data
